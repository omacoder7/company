<?php

namespace Database\Seeders;

use App\Models\CaseStudy;
use Illuminate\Database\Seeder;

class CaseStudySeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $cases = [
            [
                'title' => 'E-commerce платформа',
                'client' => 'Крупный ритейлер',
                'niche' => 'Электронная коммерция',
                'task' => 'Разработка высоконагруженной платформы для онлайн-продаж с поддержкой тысяч одновременных пользователей, интеграцией платежных систем и системой управления заказами.',
                'solution' => 'Архитектура на Laravel с микросервисами, Redis для кеширования, PostgreSQL для данных. Интеграция с платежными системами, система управления складом, аналитика продаж.',
                'result' => 'Платформа обрабатывает более 10,000 заказов в день, время загрузки страниц менее 1 секунды, конверсия увеличилась на 35%.',
                'image' => null,
                'order' => 1,
                'is_active' => true,
            ],
            [
                'title' => 'Корпоративный портал',
                'client' => 'Финансовая компания',
                'niche' => 'Финансы',
                'task' => 'Создание внутреннего корпоративного портала для управления документами, задачами и коммуникацией между отделами с высоким уровнем безопасности.',
                'solution' => 'Разработка на Laravel с двухфакторной аутентификацией, шифрованием данных, системой ролей и прав доступа. Интеграция с корпоративными системами.',
                'result' => 'Портал объединил 500+ сотрудников, время на поиск документов сократилось на 60%, повысилась безопасность данных.',
                'image' => null,
                'order' => 2,
                'is_active' => true,
            ],
            [
                'title' => 'Мобильное приложение для доставки',
                'client' => 'Сервис доставки',
                'niche' => 'Логистика',
                'task' => 'Разработка мобильного приложения для курьеров и клиентов с отслеживанием заказов в реальном времени и интеграцией с картами.',
                'solution' => 'Кроссплатформенное приложение на React Native, backend на Laravel, интеграция с картографическими сервисами, push-уведомления, система рейтингов.',
                'result' => 'Приложение установили 50,000+ пользователей, средний рейтинг 4.8, время доставки сократилось на 25%.',
                'image' => null,
                'order' => 3,
                'is_active' => true,
            ],
            [
                'title' => 'API для интеграции систем',
                'client' => 'Технологическая компания',
                'niche' => 'Интеграции',
                'task' => 'Создание универсального API для интеграции различных CRM и ERP систем с единой точкой доступа и документацией.',
                'solution' => 'RESTful API на Laravel с версионированием, документацией Swagger, OAuth 2.0 аутентификацией, rate limiting и мониторингом.',
                'result' => 'API интегрирован с 15+ системами, обрабатывает 100,000+ запросов в день, время отклика менее 100ms.',
                'image' => null,
                'order' => 4,
                'is_active' => true,
            ],
            [
                'title' => 'Облачная инфраструктура',
                'client' => 'Стартап',
                'niche' => 'Облачные технологии',
                'task' => 'Настройка масштабируемой облачной инфраструктуры с автоматическим деплоем, мониторингом и резервным копированием.',
                'solution' => 'Docker контейнеризация, Kubernetes оркестрация, CI/CD на GitLab, мониторинг через Prometheus и Grafana, автоматическое масштабирование.',
                'result' => 'Инфраструктура автоматически масштабируется под нагрузку, время деплоя сократилось с 2 часов до 10 минут, uptime 99.9%.',
                'image' => null,
                'order' => 5,
                'is_active' => true,
            ],
            [
                'title' => 'Система аналитики',
                'client' => 'Маркетинговое агентство',
                'niche' => 'Аналитика',
                'task' => 'Разработка системы сбора и анализа данных из различных источников с визуализацией в реальном времени.',
                'solution' => 'Backend на Laravel для сбора данных, фронтенд на Vue.js для визуализации, интеграция с Google Analytics, Facebook Ads, система дашбордов.',
                'result' => 'Система обрабатывает данные из 20+ источников, время генерации отчетов сократилось с 4 часов до 5 минут, точность данных 99.8%.',
                'image' => null,
                'order' => 6,
                'is_active' => true,
            ],
        ];

        foreach ($cases as &$case) {
            $sections = [];

            $detailsItems = [];
            if (!empty($case['client'])) {
                $detailsItems[] = [
                    'label' => 'Клиент',
                    'value' => $case['client'],
                ];
            }

            if (!empty($case['niche'])) {
                $detailsItems[] = [
                    'label' => 'Ниша',
                    'value' => $case['niche'],
                ];
            }

            if (!empty($detailsItems)) {
                $sections[] = [
                    'title' => 'Информация о проекте',
                    'type' => 'details',
                    'content' => null,
                    'items' => [],
                    'details' => $detailsItems,
                ];
            }

            if (!empty($case['task'])) {
                $sections[] = [
                    'title' => 'Задача',
                    'type' => 'text',
                    'content' => $case['task'],
                    'items' => [],
                    'details' => [],
                ];
            }

            if (!empty($case['solution'])) {
                $sections[] = [
                    'title' => 'Решение',
                    'type' => 'text',
                    'content' => $case['solution'],
                    'items' => [],
                    'details' => [],
                ];
            }

            if (!empty($case['result'])) {
                $sections[] = [
                    'title' => 'Результат',
                    'type' => 'text',
                    'content' => $case['result'],
                    'items' => [],
                    'details' => [],
                ];
            }

            // Убираем старые поля и оставляем только нужные
            $caseData = [
                'title' => $case['title'],
                'sections' => $sections,
                'image' => $case['image'] ?? null,
                'order' => $case['order'],
                'is_active' => $case['is_active'],
            ];

            CaseStudy::create($caseData);
        }
        unset($case);
    }
}

